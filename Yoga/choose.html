<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Choose Your Sequence</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #c4a0ff, #a0d2ff);
    }

    .top-nav {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 999;
      display: flex;
      gap: 10px;
    }

    .top-nav button {
      padding: 8px 16px;
      font-size: 14px;
      background-color: #6c63ff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .pose-section {
      padding: 30px;
    }

    .pose-category {
      margin-bottom: 60px;
    }

    .pose-category h2 {
      font-size: 26px;
      margin: 10px 0 15px;
      color: #2c2c2c;
      padding-left: 20px;
    }

    .carousel-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .carousel-inner {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      scroll-behavior: smooth;
      padding: 10px 40px;
    }

    .carousel-inner::-webkit-scrollbar {
      display: none;
    }

    .pose-card {
      flex: 0 0 180px;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
      text-align: center;
      overflow: hidden;
      padding: 10px;
      transition: 0.2s;
      border: 2px dashed transparent;
      cursor: grab;
    }

    .pose-card:active {
      cursor: grabbing;
    }

    .pose-card img {
      width: 100%;
      height: 140px;
      object-fit: contain;
    }

    .pose-title {
      font-weight: bold;
      font-size: 16px;
      margin-top: 10px;
    }

    .pose-time {
      font-style: italic;
      font-size: 14px;
      margin-top: 4px;
    }

    .drop-zone {
      width: 260px;
      height: 260px;
      margin: 40px auto;
      border-radius: 50%;
      background: #f4f4f8;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      flex-direction: column;
    }

    .drop-zone img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
    }

    .drop-hint {
      position: absolute;
      bottom: 10px;
      width: 100%;
      text-align: center;
      font-size: 0.9rem;
      color: #555;
    }

    .action-btn {
      display: block;
      margin: 0 auto 40px;
      padding: 12px 24px;
      font-size: 16px;
      background-color: #6c63ff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .action-btn:hover {
      background-color: #574fe7;
    }
  </style>
</head>
<body>
  <div class="top-nav">
    <button onclick="window.location.href='index.html'">Return to Home</button>
    <button onclick="launchMusic()">ðŸ”Š Music</button>
  </div>

  <div class="pose-section" id="pose-section"></div>

  <!-- Drop Zone -->
  <div id="dropZone" class="drop-zone" ondrop="handleDrop(event)" ondragover="allowDrop(event)">
    <img src="brain-watering.png" alt="Watering the Mind" />
    <div class="drop-hint" id="dropHint">Drag poses here to nurture your mind</div>
  </div>

  <button class="action-btn" onclick="submitSequence()">Begin My Practice</button>

  <script>
    function launchMusic() {
      if (!window.musicPlayer || window.musicPlayer.closed) {
        window.musicPlayer = window.open('music.html', 'MusicWindow', 'width=200,height=100,left=200,top=200');
      } else {
        window.musicPlayer.focus();
      }
    }

    document.addEventListener("click", () => {
      launchMusic();
    }, { once: true });

    const posesByCategory = {
      "Legs": ["Butterfly Stretch", "Seated Forward Fold", "Low Lunge", "Low Lunge to Crescent Lunge", "Pigeon Pose", "Lizard Lunge", "Happy Baby", "Goddess Pose Pulses", "Goddess Pose Flow", "Jump Squats", "Jumping Jacks", "Warrior II", "Crescent Lunge", "Frog Pose", "Bridge Pose", "Supine Twist"],
      "Arms": ["Neck Rolls", "Shoulder Rolls", "Thread the Needle", "Puppy Pose", "Eagle Arms", "Cow Face Arms", "Supported Fish Pose", "Sun Salutation A", "Sun Salutation B", "Chaturanga", "Chaturanga to Up Dog", "Chaturanga to Up Dog to Down Dog", "Dolphin Pose", "Dolphin Dips", "Plank to Down Dog", "Forearm Plank", "Reverse Tabletop"],
      "Back": ["Cat-Cow", "Childâ€™s Pose", "Supine Twist", "Knees to Chest", "Sphinx Pose", "Reclined Twist", "Reclining Twist", "Happy Baby", "Bridge Pulses", "Chair Pose", "Warrior I", "Down Dog to Plank", "Upward Facing Dog", "Locust Pose", "Camel Pose"],
      "Core": ["Figure Four Stretch", "Glute Pulses", "Plank to Down Dog", "Forearm Plank", "Chair Pose", "Boat Pose", "Bicycle Crunches", "Side Plank", "Leg Raises", "Dead Bug", "Mountain Climbers", "Crunches", "High Boat", "Side Crunches", "Flutter Kicks"],
      "Cooldown": ["Savasana", "Reclined Bound Angle", "Supported Fish Pose", "Seated Twist", "Legs Up the Wall", "Childâ€™s Pose", "Supine Bound Angle", "Corpse Pose", "Reclining Hero Pose", "Happy Baby", "Knees to Chest", "Deep Breathing", "Seated Meditation", "Side-Lying Twist", "Lying Butterfly"]
    };

    let selectedPoses = [];

    function allowDrop(e) {
      e.preventDefault();
    }

    function handleDrop(e) {
      e.preventDefault();
      const data = JSON.parse(e.dataTransfer.getData("text/plain"));
      selectedPoses.push(data);
      document.getElementById("dropHint").textContent = `"${data.name}" added to your sequence`;
    }

    function submitSequence() {
      if (selectedPoses.length === 0) {
        alert("Please drag at least one pose into the drop zone.");
        return;
      }
      sessionStorage.setItem("sequenceName", "My Flow");
      sessionStorage.setItem("sequencePoses", JSON.stringify(selectedPoses));
      window.location.href = "final-sequence.html";
    }

    document.addEventListener("DOMContentLoaded", () => {
      const section = document.getElementById("pose-section");
      for (let category in posesByCategory) {
        const catDiv = document.createElement("div");
        catDiv.className = "pose-category";

        const title = document.createElement("h2");
        title.textContent = category;
        catDiv.appendChild(title);

        const wrapper = document.createElement("div");
        wrapper.className = "carousel-wrapper";

        const carousel = document.createElement("div");
        carousel.className = "carousel-inner";

        posesByCategory[category].forEach(pose => {
          const card = document.createElement("div");
          card.className = "pose-card";
          card.setAttribute("draggable", "true");
          card.ondragstart = (e) => {
            e.dataTransfer.setData("text/plain", JSON.stringify({ name: pose, category }));
          };
          card.innerHTML = `
            <img src="poses/${pose}.jpg" alt="${pose}" onerror="this.src='poses/fallback.jpg'" />
            <div class="pose-title">${pose}</div>
            <div class="pose-time">2â€“4 min</div>
          `;
          carousel.appendChild(card);
        });

        wrapper.appendChild(carousel);
        catDiv.appendChild(wrapper);
        section.appendChild(catDiv);
      }
    });
  </script>
</body>
</html>
